<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Multimedia – Lista N°3</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    </head>
<body>
  <header class="main-header">
    <div class="logo-placeholder">Colegio Militar “Abdón Calderón”</div>
    <nav>
      <a href="../index.html">Inicio</a>
      <a href="candidates.html">Candidatos</a>
      <a href="plan.html">Plan de Trabajo</a>
      <a href="gallery.html">Galería</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Videos Oficiales</h2>
      <div class="video-grid responsive-grid">
        <div class="video-wrapper">
          <iframe id="yt-1" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Promo 1" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="video-wrapper">
          <iframe id="yt-2" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Promo 2" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="video-wrapper">
          <iframe id="yt-3" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Promo 3" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="video-wrapper">
          <iframe id="yt-4" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Promo 4" frameborder="0" allowfullscreen></iframe>
        </div>
      </div>
    </section>

    <section>
      <h2>Detrás de Cámaras</h2>
      <div class="section-mascots">
        <img src="../assets/img/mascots/pucca3.png" class="section-mascot pucca-m">
        <img src="../assets/img/mascots/garu3.png" class="section-mascot garu-m">
        <img src="../assets/img/mascots/cat3.png" class="section-mascot cat-m">
      </div>
      <div class="video-grid responsive-grid">
        <div class="video-wrapper">
          <iframe id="yt-5" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Fun 1" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="video-wrapper">
          <iframe id="yt-6" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Fun 2" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="video-wrapper">
          <iframe id="yt-7" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Fun 3" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="video-wrapper">
          <iframe id="yt-8" src="https://www.youtube.com/embed/cTGkSE8HXAs?enablejsapi=1" title="Fun 4" frameborder="0" allowfullscreen></iframe>
        </div>
      </div>
    </section>

        <section>
      <h2>Nuestra Música</h2>
      <div class="section-mascots">
        <img src="../assets/img/mascots/pucca3.png" class="section-mascot pucca-m">
        <img src="../assets/img/mascots/garu3.png" class="section-mascot garu-m">
        <img src="../assets/img/mascots/cat3.png" class="section-mascot cat-m">
      </div>
        
        <div class="spotify-tab-buttons">
            <div class="tab-button active" data-target="sp-list-1">Lista 1: Hits Urbanos</div>
            <div class="tab-button" data-target="sp-list-2">Lista 2: Pop</div>
            <div class="tab-button" data-target="sp-list-3">Lista 3: Clásicos</div>
            <div class="tab-button" data-target="sp-list-4">Lista 4: Electrónica</div>
        </div>

        <div class="spotify-content-wrapper">
            <div id="sp-list-1" class="spotify-tab-content active">
                <iframe id="sp-1" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DWVskFRGurTfg?si=bdMj8_jZRt2xKzM0rbawfQ&pi=Mnsj7ipTRcup2" width="100%" height="152" frameborder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
            </div>
            <div id="sp-list-2" class="spotify-tab-content">
                <iframe id="sp-2" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/3uJZmp4VHIjKQorIj6DzIN?si=2QxQuLQfSoinwtCfYd7NIw" width="100%" height="152" frameborder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
            </div>
            <div id="sp-list-3" class="spotify-tab-content">
                <iframe id="sp-3" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/6DGhgf1V0p99R30uuktBRG?si=q5yog6XETGCY1nIboGOFfQ" width="100%" height="152" frameborder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
            </div>
            <div id="sp-list-4" class="spotify-tab-content">
                <iframe id="sp-4" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DX1ngEVM0lKrb?si=MUQoxA0OQnGFhMGjpsvNRw" width="100%" height="152" frameborder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
            </div>
        </div>
        
    </section>
  </main>

  <footer>
    <p>© 2025 Lista N°3 – Unidad Educativa de Fuerzas Armadas Colegio Militar N°4 “Abdón Calderón” • Cuenca, Ecuador</p>
  </footer>

<script>
  // -----------------------------------------------------
  // 1. GESTIÓN DE LA REPRODUCCIÓN SIMULTÁNEA DE YOUTUBE
  // -----------------------------------------------------
  let youtubePlayers = [];
  const youtubeIframes = document.querySelectorAll('iframe[id^="yt-"]');

  var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  function onYouTubeIframeAPIReady() {
    youtubeIframes.forEach((iframe) => {
      const player = new YT.Player(iframe.id, {
        events: {
          'onStateChange': onPlayerStateChange
        }
      });
      youtubePlayers.push(player);
    });
  }

  function onPlayerStateChange(event) {
    if (event.data === YT.PlayerState.PLAYING) {
      const activePlayer = event.target;
      
      // Detiene todos los demás reproductores de YouTube
      youtubePlayers.forEach((player) => {
        if (player !== activePlayer && player.getPlayerState() === YT.PlayerState.PLAYING) {
          player.stopVideo(); 
        }
      });
      
      // Detiene todos los reproductores de Spotify al iniciar un video de YouTube
      resetAllSpotifyIframes();
    }
  }

  // -----------------------------------------------------
  // 2. GESTIÓN DE LAS PESTAÑAS (TABS) DE SPOTIFY
  // -----------------------------------------------------

  const tabButtons = document.querySelectorAll('.tab-button');
  const tabContents = document.querySelectorAll('.spotify-tab-content');
  const spotifyIframes = document.querySelectorAll('.spotify-tab-content iframe');
  
  // Función para resetear TODOS los iframes de Spotify (forzar la pausa)
  function resetAllSpotifyIframes() {
      spotifyIframes.forEach(iframe => {
          // Solución robusta: vaciar el src, forzando la detención, y luego restaurarlo
          const originalSrc = iframe.src;
          iframe.src = '';
          iframe.src = originalSrc;
      });
  }

  // Lógica para mostrar la pestaña seleccionada
  tabButtons.forEach(button => {
      button.addEventListener('click', function() {
          const targetId = this.getAttribute('data-target');
          
          // 1. Pausa el reproductor de YouTube activo (si lo hay)
          youtubePlayers.forEach(player => {
              if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                  player.stopVideo();
              }
          });
          
          // 2. Resetea (pausa) todos los iframes de Spotify antes de cambiar la pestaña
          resetAllSpotifyIframes();

          // 3. Oculta todos los contenidos y desactiva todos los botones
          tabContents.forEach(content => content.classList.remove('active'));
          tabButtons.forEach(btn => btn.classList.remove('active'));

          // 4. Muestra el contenido objetivo y activa el botón
          document.getElementById(targetId).classList.add('active');
          this.classList.add('active');
      });
  });

  // Asegurar que solo un iframe de Spotify esté visible al cargar la página.
  // Esto es vital para que la lista 1 funcione correctamente desde el inicio.
  document.addEventListener('DOMContentLoaded', function() {
      // Inicia la primera lista. Si la clase 'active' ya está en el HTML, esto no hace daño.
      const firstTabId = tabButtons[0].getAttribute('data-target');
      document.getElementById(firstTabId).classList.add('active');
      tabButtons[0].classList.add('active');
  });
</script>
</body>
</html>